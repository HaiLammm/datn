# Story 8.2: Tương tác giọng nói với AI phỏng vấn

## Epic
Phòng Phỏng vấn AI Ảo

## Mô tả
**Là một** Ứng viên, **tôi muốn** tương tác với AI phỏng vấn bằng giọng nói và nhận phản hồi bằng giọng nói, **để** trải nghiệm phỏng vấn chân thực hơn.

## Tiêu chí chấp nhận (Acceptance Criteria)
1.  Ứng viên phải có thể sử dụng microphone để ghi âm câu trả lời của mình cho câu hỏi của AI.
2.  Hệ thống phải có khả năng chuyển đổi giọng nói của ứng viên thành văn bản (Speech-to-Text).
3.  AI phải có khả năng phân tích câu trả lời bằng văn bản của ứng viên và tạo ra phản hồi phù hợp.
4.  Hệ thống phải có khả năng chuyển đổi phản hồi văn bản của AI thành giọng nói (Text-to-Speech).
5.  Ứng viên phải có thể nghe phản hồi bằng giọng nói của AI một cách rõ ràng.
6.  Quá trình tương tác giọng nói phải diễn ra mượt mà và gần như tức thì.
7.  Hệ thống phải xử lý được các trường hợp gián đoạn kết nối hoặc lỗi microphone một cách ổn định.
8.  Hệ thống phải lưu lại file âm thanh câu trả lời của ứng viên.
9.  Toàn bộ bản ghi của cuộc phỏng vấn (bao gồm cả văn bản và file âm thanh) phải được lưu lại và có thể được truy xuất sau này.

## Nhiệm vụ (Tasks)

-   **Backend:**
    -   **[AI/API]** Xây dựng API endpoint để nhận văn bản đã được chuyển đổi từ giọng nói của người dùng và chuyển nó đến cho AI xử lý.
    -   **[API]** Xây dựng một API endpoint để Frontend có thể tải lên file âm thanh đã ghi của người dùng.
    -   **[AI/API]** API endpoint trên sẽ trả về phản hồi dưới dạng văn bản từ AI.
    -   **[AI/Tùy chọn]** Tích hợp một dịch vụ Text-to-Speech (TTS) để chuyển đổi phản hồi văn bản của AI thành file âm thanh. API có thể trả về URL của file âm thanh này.
    -   **[Real-time]** Cập nhật WebSocket để có thể gửi trạng thái xử lý (ví dụ: "AI đang suy nghĩ...") đến frontend.
    -   **[Database]** Tạo một bảng mới `interview_turns` để lưu trữ từng lượt tương tác, bao gồm văn bản câu hỏi của AI, văn bản câu trả lời của người dùng, và đường dẫn đến file âm thanh tương ứng.
    -   **[Storage]** Thiết lập giải pháp lưu trữ cho các file âm thanh (ví dụ: lưu vào một thư mục trên server hoặc sử dụng dịch vụ lưu trữ đám mây như Amazon S3).

-   **Frontend:**
    -   **[UI]** Xây dựng giao diện chính của phòng phỏng vấn, bao gồm khu vực hiển thị câu hỏi của AI và trạng thái.
    -   **[UI]** Thiết kế và xây dựng nút ghi âm (microphone button) với các trạng thái khác nhau (sẵn sàng, đang ghi, đang xử lý).
    -   **[Logic]** Tích hợp với Web Speech API của trình duyệt hoặc một thư viện bên ngoài để thực hiện Speech-to-Text (chuyển giọng nói thành văn bản).
    -   **[Logic]** Gửi văn bản đã được chuyển đổi đến backend API để AI xử lý.
    -   **[Logic]** Sau khi người dùng ghi âm xong, gửi file âm thanh đến API của backend để lưu trữ.
    -   **[Logic]** Nhận phản hồi từ backend và:
        -   Hiển thị phản hồi dưới dạng văn bản.
        -   Hoặc, nếu có âm thanh, phát file âm thanh phản hồi từ AI (Text-to-Speech).
    -   **[Logic]** Xử lý các lỗi liên quan đến microphone (ví dụ: không cấp quyền, không tìm thấy thiết bị).

## Ghi chú phát triển (Dev Notes)
- ... (Sẽ được bổ sung sau)
